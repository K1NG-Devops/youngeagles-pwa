var e=(e,t,s)=>new Promise((a,r)=>{var l=e=>{try{x(s.next(e))}catch(t){r(t)}},d=e=>{try{x(s.throw(e))}catch(t){r(t)}},x=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,d);x((s=s.apply(e,t)).next())});import{r as t}from"./vendor-react-BHu_3aIX.js";import{u as s,l as a,j as r,r as l,R as d,d as x,a7 as i,L as n,f as o,a8 as c,a0 as m,I as g,b,a9 as h,aa as u,q as p,ab as y,ac as j,A as f,n as N,ad as v,ae as w,a3 as k,af as C,ag as $,a1 as S,ah as _,C as P,W as D}from"./index-BetBoxhn.js";import{u as R}from"./vendor-router-BfAStt8k.js";import"./vendor-utils-C_UPlz3V.js";const A=()=>{const{user:A}=s(),{isDark:F}=a(),M=R(),[T,B]=t.useState([]),[E,I]=t.useState([]),[L,W]=t.useState(""),[q,G]=t.useState(!0),[H,O]=t.useState({total:0,pending:0,submitted:0,graded:0,overdue:0,completionRate:0,weekStreak:0,totalPoints:0});t.useEffect(()=>{e(void 0,null,function*(){var e;try{G(!0);const t=(yield f.children.getByParent(A.id)).data.children||[];I(t),t.length>0&&!L&&W(t[0].id.toString());const s=L||(null==(e=t[0])?void 0:e.id.toString());s&&(yield V(s))}catch(t){N.error("Failed to load homework data"),I([]),B([]),O({total:0,pending:0,submitted:0,graded:0,overdue:0,completionRate:0,weekStreak:0,totalPoints:0})}finally{G(!1)}})},[A.id,L]);const V=t=>e(void 0,null,function*(){try{const e=(yield f.homework.getByParent(A.id,t)).data.homework||[];B(e);const s=e.length,a=e.filter(e=>"pending"===e.status).length,r=e.filter(e=>"submitted"===e.status).length,l=e.filter(e=>"graded"===e.status).length,d=e.filter(e=>{const t=new Date(e.due_date);return"pending"===e.status&&t<new Date}).length,x=s>0?Math.round((r+l)/s*100):0,i=e.filter(e=>"graded"===e.status&&e.score).reduce((e,t)=>e+(t.score||0),0);O({total:s,pending:a,submitted:r,graded:l,overdue:d,completionRate:x,weekStreak:5,totalPoints:i})}catch(e){B([]),O({total:0,pending:0,submitted:0,graded:0,overdue:0,completionRate:0,weekStreak:0,totalPoints:0})}}),Y=e=>{const t=new Date(e)-new Date,s=Math.ceil(t/864e5);return 0===s?"Due today":1===s?"Due tomorrow":s>0?`Due in ${s} days`:`${Math.abs(s)} days overdue`};return q?r.jsx("div",{className:`min-h-screen ${F?"bg-gray-900":"bg-gray-50"} p-4`,children:r.jsx("div",{className:"max-w-7xl mx-auto",children:r.jsx("div",{className:"flex items-center justify-center py-20",children:r.jsxs("div",{className:"text-center",children:[r.jsx(l,{className:"animate-spin text-4xl text-blue-500 mx-auto mb-4"}),r.jsx("p",{className:""+(F?"text-gray-300":"text-gray-600"),children:"Loading homework dashboard..."})]})})})}):r.jsx("div",{className:(F?"bg-gray-900":"bg-gray-50")+" p-2 sm:p-4 pb-20",children:r.jsxs("div",{className:"max-w-7xl mx-auto",children:[r.jsxs("div",{className:"mb-4 sm:mb-6",children:[r.jsx("h1",{className:`text-xl sm:text-2xl font-bold ${F?"text-white":"text-gray-900"} mb-2`,children:"ğŸ“š Homework Dashboard"}),r.jsx("p",{className:"text-sm sm:text-base "+(F?"text-gray-400":"text-gray-600"),children:"Track your child's learning progress and assignments"})]}),r.jsx("div",{className:"mb-4 sm:mb-6",children:r.jsx(d,{placement:"content"})}),E.length>1&&r.jsxs("div",{className:"mb-4 sm:mb-6",children:[r.jsx("label",{className:`block text-sm font-medium ${F?"text-gray-300":"text-gray-700"} mb-2`,children:"Select Child"}),r.jsx("select",{value:L,onChange:e=>W(e.target.value),className:"w-full sm:max-w-sm px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 "+(F?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:E.map(e=>r.jsxs("option",{value:e.id.toString(),children:[e.first_name," ",e.last_name]},e.id))})]}),r.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2 sm:gap-4 mb-6 sm:mb-8",children:[r.jsx("div",{className:"p-3 sm:p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xl sm:text-2xl font-bold "+(F?"text-white":"text-gray-900"),children:H.total}),r.jsx("p",{className:"text-xs sm:text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Total Assignments"})]}),r.jsx(x,{className:"text-blue-500 text-lg sm:text-xl"})]})}),r.jsx("div",{className:"p-3 sm:p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xl sm:text-2xl font-bold text-orange-500",children:H.pending}),r.jsx("p",{className:"text-xs sm:text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Pending"})]}),r.jsx(i,{className:"text-orange-500 text-lg sm:text-xl"})]})}),r.jsx("div",{className:"p-3 sm:p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-500",children:H.submitted+H.graded}),r.jsx("p",{className:"text-xs sm:text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Completed"})]}),r.jsx(n,{className:"text-green-500 text-lg sm:text-xl"})]})}),r.jsx("div",{className:"p-3 sm:p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsxs("p",{className:"text-xl sm:text-2xl font-bold text-purple-500",children:[H.completionRate,"%"]}),r.jsx("p",{className:"text-xs sm:text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Completion Rate"})]}),r.jsx(o,{className:"text-purple-500 text-lg sm:text-xl"})]})}),r.jsx("div",{className:"p-3 sm:p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:H.weekStreak}),r.jsx("p",{className:"text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Day Streak"})]}),r.jsx(c,{className:"text-yellow-500 text-xl"})]})}),r.jsx("div",{className:"p-4 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-2xl font-bold text-indigo-500",children:H.totalPoints}),r.jsx("p",{className:"text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Points Earned"})]}),r.jsx(m,{className:"text-indigo-500 text-xl"})]})})]}),r.jsx("div",{className:"mb-4 sm:mb-6",children:r.jsx(g,{})}),r.jsxs("div",{className:"space-y-3 sm:space-y-4 w-full",children:[r.jsxs("h2",{className:`text-lg sm:text-xl font-semibold ${F?"text-white":"text-gray-900"} mb-3 sm:mb-4`,children:["ğŸ“‹ Current Assignments (",T.length,")"]}),0===T.length?r.jsxs("div",{className:"text-center py-8 sm:py-12 rounded-xl border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[r.jsx(b,{className:"text-4xl sm:text-6xl mx-auto mb-4 "+(F?"text-gray-600":"text-gray-400")}),r.jsx("h3",{className:`text-lg sm:text-xl font-semibold ${F?"text-gray-300":"text-gray-600"} mb-2`,children:"No assignments yet"}),r.jsx("p",{className:"text-gray-500",children:"Your child's homework assignments will appear here once assigned by their teacher."})]}):r.jsx("div",{className:"grid gap-4 w-full",children:T.map(e=>{const t=(s=e.subject,{literacy:_,mathematics:S,science:$,"social-studies":C,arts:k,"life-skills":w,technology:v}[s]||x);var s;const a=(e=>{const t={pending:{color:"orange",icon:i,text:"Not Started",bgClass:"bg-orange-100 dark:bg-orange-900",textClass:"text-orange-800 dark:text-orange-200",borderClass:"border-orange-200 dark:border-orange-700"},in_progress:{color:"blue",icon:D,text:"In Progress",bgClass:"bg-blue-100 dark:bg-blue-900",textClass:"text-blue-800 dark:text-blue-200",borderClass:"border-blue-200 dark:border-blue-700"},submitted:{color:"green",icon:n,text:"Submitted",bgClass:"bg-green-100 dark:bg-green-900",textClass:"text-green-800 dark:text-green-200",borderClass:"border-green-200 dark:border-green-700"},graded:{color:"purple",icon:m,text:"Graded",bgClass:"bg-purple-100 dark:bg-purple-900",textClass:"text-purple-800 dark:text-purple-200",borderClass:"border-purple-200 dark:border-purple-700"},overdue:{color:"red",icon:P,text:"Overdue",bgClass:"bg-red-100 dark:bg-red-900",textClass:"text-red-800 dark:text-red-200",borderClass:"border-red-200 dark:border-red-700"}};return t[e]||t.pending})(e.status),l=a.icon;return r.jsx("div",{className:`p-4 sm:p-6 rounded-xl border transition-all hover:shadow-lg w-full max-w-full overflow-hidden ${F?"bg-gray-800 border-gray-700 hover:bg-gray-750":"bg-white border-gray-200 hover:shadow-xl"} ${a.borderClass}`,children:r.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between w-full",children:r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[r.jsx("div",{className:`p-2 rounded-lg ${a.bgClass} flex-shrink-0`,children:r.jsx(t,{className:`text-base sm:text-lg ${a.textClass}`})}),r.jsxs("div",{className:"flex-1 min-w-0",children:[r.jsx("h3",{className:`font-semibold text-base sm:text-lg ${F?"text-white":"text-gray-900"} truncate`,children:e.title}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-4 text-xs sm:text-sm",children:[r.jsxs("span",{className:"flex items-center gap-1 "+(F?"text-gray-400":"text-gray-600"),children:[r.jsx(h,{className:"text-xs"}),e.teacher_name||"Teacher"]}),r.jsxs("span",{className:"flex items-center gap-1 "+(F?"text-gray-400":"text-gray-600"),children:[r.jsx(u,{className:"text-xs"}),Y(e.due_date)]}),r.jsxs("span",{className:"flex items-center gap-1 "+(F?"text-gray-400":"text-gray-600"),children:[r.jsx(i,{className:"text-xs"}),e.duration||30," mins"]})]})]})]}),r.jsx("p",{className:`text-xs sm:text-sm ${F?"text-gray-300":"text-gray-700"} mb-4 line-clamp-2`,children:e.description}),r.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[r.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-xs sm:text-sm font-medium ${a.bgClass} ${a.textClass} w-fit`,children:[r.jsx(l,{className:"text-xs"}),a.text,"graded"===e.status&&e.score&&r.jsxs("span",{className:"ml-1",children:["â€¢ ",e.score,"%"]})]}),r.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[r.jsxs("button",{onClick:()=>M(`/homework/${e.id}?child_id=${L}`),className:"inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-lg transition-colors "+(F?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[r.jsx(p,{className:"text-xs"}),"View Details"]}),"pending"===e.status&&r.jsx("button",{onClick:()=>{var t;"interactive"===(t=e).content_type?M(`/homework/${t.id}?child_id=${L}`):M(`/submit-work?homework_id=${t.id}&child_id=${L}`)},className:"inline-flex items-center justify-center gap-2 px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium text-white rounded-lg transition-colors "+("interactive"===e.content_type?"bg-green-600 hover:bg-green-700":"bg-blue-600 hover:bg-blue-700"),children:"interactive"===e.content_type?r.jsxs(r.Fragment,{children:[r.jsx(y,{className:"text-xs"}),"Start Activity"]}):r.jsxs(r.Fragment,{children:[r.jsx(j,{className:"text-xs"}),"Submit Work"]})})]})]})]})})},e.id)})})]})]})})},F=()=>r.jsx(A,{});export{F as default};
