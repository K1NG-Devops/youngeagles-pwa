var i=Object.defineProperty,e=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(e,t,r)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,s=(i,e,t)=>new Promise((r,n)=>{var s=i=>{try{u(t.next(i))}catch(e){n(e)}},o=i=>{try{u(t.throw(i))}catch(e){n(e)}},u=i=>i.done?r(i.value):Promise.resolve(i.value).then(s,o);u((t=t.apply(i,e)).next())});import{A as o}from"./index-BetBoxhn.js";const u=new class{constructor(){this.vapidPublicKey="BFiweLvvifGzxAkgyHfPFfkYihM6Z4iWuhLjOHxbARRFxrRO2TUb-povu4m7XkFB6N6CCy2FeTRXy87eup-xzYU",this.subscription=null,this.isSupported="serviceWorker"in navigator&&"PushManager"in window}isSupported(){return this.isSupported}urlBase64ToUint8Array(i){const e=(i+"=".repeat((4-i.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(e),r=new Uint8Array(t.length);for(let n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}requestPermission(){return s(this,null,function*(){if(!this.isSupported)throw new Error("Push notifications are not supported");let i=Notification.permission;return"default"===i&&(i=yield Notification.requestPermission()),"granted"===i||"denied"===i&&(this.showPermissionDeniedMessage(),!1)})}showPermissionDeniedMessage(){window.confirm("Push notifications are disabled. Would you like to enable them to receive important updates? Click OK to learn how.")&&alert('To enable notifications:\n\n1. Click the lock icon in your browser\'s address bar\n2. Change "Notifications" to "Allow"\n3. Refresh the page\n\nOr check your browser settings for notification permissions.')}subscribe(){return s(this,null,function*(){try{if(!this.vapidPublicKey)return null;if(!(yield this.requestPermission()))throw new Error("Push notification permission denied");const e=yield navigator.serviceWorker.ready,t=yield e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(this.vapidPublicKey)});this.subscription=t;try{yield o.push.subscribe(t)}catch(i){}return t}catch(i){throw i}})}unsubscribe(){return s(this,null,function*(){try{const e=yield navigator.serviceWorker.ready,t=yield e.pushManager.getSubscription();if(t){yield t.unsubscribe();try{yield o.push.unsubscribe(t.endpoint)}catch(i){}}return this.subscription=null,!0}catch(i){throw i}})}getSubscription(){return s(this,null,function*(){if(!this.isSupported)return null;try{const i=yield navigator.serviceWorker.ready,e=yield i.pushManager.getSubscription();return this.subscription=e,e}catch(i){return null}})}isSubscribed(){return s(this,null,function*(){return!!(yield this.getSubscription())})}getVapidPublicKey(){return s(this,null,function*(){try{return(yield o.push.getVapidPublicKey()).data.publicKey}catch(i){return this.vapidPublicKey}})}showLocalNotification(i,s={}){if(this.isSupported&&"granted"===Notification.permission){const o=new Notification(i,((i,s)=>{for(var o in s||(s={}))t.call(s,o)&&n(i,o,s[o]);if(e)for(var o of e(s))r.call(s,o)&&n(i,o,s[o]);return i})({icon:"/icons/icon-192x192.png",badge:"/icons/icon-192x192.png",requireInteraction:!0,vibrate:[200,100,200]},s));return setTimeout(()=>{o.close()},5e3),o}}testPushNotification(){return s(this,null,function*(){try{(yield this.isSubscribed())||(yield this.subscribe());yield o.push.sendTest();return this.showLocalNotification("Test Notification",{body:"This is a test notification from Young Eagles!",tag:"test-notification"}),!0}catch(i){throw i}})}getNotificationStatus(){return s(this,null,function*(){return{isSupported:this.isSupported,permission:Notification.permission,isSubscribed:yield this.isSubscribed(),subscription:yield this.getSubscription()}})}};export{u as p};
