var e=(e,r,t)=>new Promise((s,a)=>{var l=e=>{try{o(t.next(e))}catch(r){a(r)}},i=e=>{try{o(t.throw(e))}catch(r){a(r)}},o=e=>e.done?s(e.value):Promise.resolve(e.value).then(l,i);o((t=t.apply(e,r)).next())});import{r}from"./vendor-react-BHu_3aIX.js";import{u as t,d as s}from"./vendor-router-BfAStt8k.js";import{u as a,l,j as i,r as o,C as d,_ as n,ac as c,b as m,aa as x,E as g,bn as h,D as u,aK as b,A as y,n as p,bo as f,bp as j,bq as v,aB as w}from"./index-BetBoxhn.js";import"./vendor-utils-C_UPlz3V.js";const N=()=>{var N;const k=t(),[S]=s(),{user:D}=a(),{isDark:F}=l(),_=S.get("homework_id"),$=S.get("child_id"),[C,B]=r.useState(null),[M,P]=r.useState($||""),[A,E]=r.useState([]),[G,I]=r.useState([]),[L,O]=r.useState(""),[W,q]=r.useState(!1),[z,U]=r.useState(0),[H,K]=r.useState(!1),[R,J]=r.useState(!0),[T,X]=r.useState(null);r.useEffect(()=>{e(void 0,null,function*(){if(null==D?void 0:D.id)try{if("parent"===D.role){const e=(yield y.children.getByParent(D.id)).data.children||[];E(e),!M&&e.length>0&&P(e[0].id.toString())}}catch(e){p.error("Failed to load children data")}})},[D,M]),r.useEffect(()=>{e(void 0,null,function*(){var e,r;if(!_)return X("No homework ID provided"),void J(!1);try{J(!0),X(null);const e=(yield y.homework.getById(_)).data.homework;B(e)}catch(t){X((null==(r=null==(e=t.response)?void 0:e.data)?void 0:r.message)||"Failed to load homework details"),p.error("Failed to load homework details")}finally{J(!1)}})},[_]);const Y=e=>{const r=["image/jpeg","image/png","image/gif","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],t=e.filter(e=>e.size>10485760?(p.error(`File ${e.name} is too large. Maximum size is 10MB.`),!1):!!r.includes(e.type)||(p.error(`File ${e.name} is not a supported type.`),!1));I(e=>[...e,...t])},Q=e=>{if(0===e)return"0 Bytes";const r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(2))+" "+["Bytes","KB","MB","GB"][r]};return R?i.jsx("div",{className:`min-h-screen ${F?"bg-gray-900":"bg-gray-50"} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center",children:[i.jsx(o,{className:"animate-spin text-4xl text-blue-500 mx-auto mb-4"}),i.jsx("p",{className:""+(F?"text-gray-300":"text-gray-600"),children:"Loading homework details..."})]})}):T?i.jsx("div",{className:`min-h-screen ${F?"bg-gray-900":"bg-gray-50"} flex items-center justify-center`,children:i.jsxs("div",{className:"text-center max-w-md mx-auto px-4 sm:px-6 p-6",children:[i.jsx(d,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-bold mb-2 "+(F?"text-white":"text-gray-900"),children:"Error Loading Homework"}),i.jsx("p",{className:(F?"text-gray-300":"text-gray-600")+" mb-4",children:T}),i.jsxs("button",{onClick:()=>k(-1),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(n,{className:"w-4 h-4 mr-2"}),"Go Back"]})]})}):C?i.jsx("div",{className:`min-h-screen ${F?"bg-gray-900":"bg-gray-50"} transition-colors duration-200`,children:i.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-4 space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("button",{onClick:()=>k(-1),className:"inline-flex items-center px-4 py-2 rounded-lg transition-colors "+(F?"text-gray-300 hover:bg-gray-800 hover:text-white":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"),children:[i.jsx(n,{className:"w-4 h-4 mr-2"}),"Back"]}),i.jsxs("div",{className:"text-sm font-medium px-4 py-2 rounded-lg "+(F?"text-gray-300 bg-gray-700":"text-gray-600 bg-gray-100"),children:[i.jsx(c,{className:"w-4 h-4 mr-2 inline"}),"Submit Work"]})]}),i.jsxs("div",{className:"rounded-lg shadow-lg overflow-hidden border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[i.jsxs("div",{className:"px-6 py-5 border-b "+(F?"border-gray-700":"border-gray-200"),children:[i.jsx("h1",{className:`text-2xl font-bold ${F?"text-white":"text-gray-900"} mb-2`,children:C.title}),C.class_name&&i.jsxs("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium mb-3 "+(F?"bg-blue-900/20 text-blue-400":"bg-blue-100 text-blue-800"),children:[i.jsx(m,{className:"w-4 h-4 mr-2"}),C.class_name]}),C.due_date&&i.jsxs("div",{className:"flex items-center text-sm",children:[i.jsx(x,{className:"w-4 h-4 mr-2 text-orange-600"}),i.jsxs("span",{className:F?"text-gray-300":"text-gray-600",children:["Due: ",(e=>{if(!e)return"Not specified";try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch(r){return e}})(C.due_date)]})]})]}),C.description&&i.jsxs("div",{className:"p-6",children:[i.jsx("h2",{className:`text-lg font-semibold ${F?"text-white":"text-gray-900"} mb-3`,children:"Instructions"}),i.jsx("div",{className:"rounded-lg p-4 border "+(F?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:i.jsx("p",{className:(F?"text-gray-300":"text-gray-700")+" whitespace-pre-wrap leading-relaxed",children:C.description})})]}),(null==(N=C.resources)?void 0:N.file_url)&&i.jsxs("div",{className:"px-6 pb-6",children:[i.jsx("h2",{className:`text-lg font-semibold ${F?"text-white":"text-gray-900"} mb-3`,children:"Resources"}),i.jsx("div",{className:"rounded-lg p-4 border "+(F?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:i.jsxs("a",{href:C.resources.file_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 rounded-lg transition-colors "+(F?"bg-purple-900/20 text-purple-400 hover:bg-purple-800/30":"bg-purple-50 text-purple-700 hover:bg-purple-100"),children:[i.jsx(g,{className:"w-4 h-4 mr-2"}),"Download Assignment File"]})})]})]}),i.jsxs("form",{onSubmit:r=>e(void 0,null,function*(){var e,t;if(r.preventDefault(),null==C?void 0:C.id)if(M)if(0!==G.length){q(!0),U(0);try{const e=new FormData;e.append("homework_id",C.id),e.append("child_id",M),e.append("comments",L),G.forEach(r=>{e.append("files",r)}),yield y.homework.submit(C.id,e),p.success("Homework submitted successfully!"),k("/homework")}catch(s){p.error((null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.message)||"Failed to submit homework")}finally{q(!1),U(0)}}else p.error("Please upload at least one file");else p.error("Please select a child");else p.error("No homework selected")}),className:"space-y-6",children:[A.length>1&&i.jsxs("div",{className:"rounded-lg shadow-sm p-6 border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[i.jsx("label",{className:`block text-sm font-medium ${F?"text-gray-300":"text-gray-700"} mb-2`,children:"Select Child"}),i.jsxs("select",{value:M,onChange:e=>P(e.target.value),className:"form-select block w-full max-w-xs rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 "+(F?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-700"),required:!0,children:[i.jsx("option",{value:"",children:"Choose a child..."}),A.map(e=>i.jsxs("option",{value:e.id,children:[e.first_name," ",e.last_name," - ",e.class_name]},e.id))]})]}),i.jsxs("div",{className:"rounded-lg shadow-sm p-6 border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[i.jsx("h3",{className:`text-lg font-semibold ${F?"text-white":"text-gray-900"} mb-4`,children:"Upload Your Work"}),i.jsxs("div",{onDragOver:e=>{e.preventDefault(),K(!0)},onDragLeave:e=>{e.preventDefault(),K(!1)},onDrop:e=>{e.preventDefault(),K(!1);const r=Array.from(e.dataTransfer.files);Y(r)},className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors "+(H?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":F?"border-gray-600 bg-gray-700":"border-gray-300 bg-gray-50"),children:[i.jsx(h,{className:"text-4xl mx-auto mb-4 "+(H?"text-blue-500":"text-gray-400")}),i.jsx("p",{className:"text-lg font-medium mb-2 "+(F?"text-white":"text-gray-900"),children:"Drop files here or click to browse"}),i.jsx("p",{className:`text-sm ${F?"text-gray-400":"text-gray-600"} mb-4`,children:"Supported formats: JPG, PNG, GIF, PDF, DOC, DOCX (Max 10MB each)"}),i.jsxs("label",{className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:[i.jsx(c,{className:"w-4 h-4 mr-2"}),"Choose Files",i.jsx("input",{type:"file",multiple:!0,accept:"image/*,.pdf,.doc,.docx",onChange:e=>{const r=Array.from(e.target.files);Y(r)},className:"hidden"})]})]}),G.length>0&&i.jsxs("div",{className:"mt-6 space-y-3",children:[i.jsxs("h4",{className:"font-medium "+(F?"text-white":"text-gray-900"),children:["Selected Files (",G.length,")"]}),G.map((e,r)=>{const t=(e=>e.type.startsWith("image/")?f:"application/pdf"===e.type?j:e.type.includes("word")?v:w)(e);return i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border "+(F?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(t,{className:"text-blue-500 text-xl"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium "+(F?"text-white":"text-gray-900"),children:e.name}),i.jsx("p",{className:"text-sm "+(F?"text-gray-400":"text-gray-600"),children:Q(e.size)})]})]}),i.jsx("button",{type:"button",onClick:()=>(e=>{I(r=>r.filter((r,t)=>t!==e))})(r),className:"text-red-500 hover:text-red-700 transition-colors",children:i.jsx(u,{})})]},r)})]})]}),i.jsxs("div",{className:"rounded-lg shadow-sm p-6 border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[i.jsx("label",{className:`block text-sm font-medium ${F?"text-gray-300":"text-gray-700"} mb-2`,children:"Comments (Optional)"}),i.jsx("textarea",{value:L,onChange:e=>O(e.target.value),rows:4,placeholder:"Add any comments about your work...",className:"block w-full rounded-lg shadow-sm focus:border-blue-500 focus:ring-blue-500 "+(F?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-700 placeholder-gray-500")})]}),i.jsxs("div",{className:"rounded-lg shadow-sm p-6 border "+(F?"bg-gray-800 border-gray-700":"bg-white border-gray-200"),children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium "+(F?"text-white":"text-gray-900"),children:"Ready to submit?"}),i.jsx("p",{className:"text-sm "+(F?"text-gray-400":"text-gray-600"),children:"Make sure you've uploaded all required files."})]}),i.jsx("button",{type:"submit",disabled:W||0===G.length||!M,className:"inline-flex items-center px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:W?i.jsxs(i.Fragment,{children:[i.jsx(o,{className:"animate-spin w-4 h-4 mr-2"}),"Submitting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(b,{className:"w-4 h-4 mr-2"}),"Submit Work"]})})]}),W&&z>0&&i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 "+(F?"bg-gray-700":"bg-gray-200"),children:i.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${z}%`}})}),i.jsxs("p",{className:"text-sm mt-1 "+(F?"text-gray-400":"text-gray-600"),children:["Uploading: ",z,"%"]})]})]})]})]})}):i.jsx("div",{className:`min-h-screen ${F?"bg-gray-900":"bg-gray-50"} flex items-center justify-center`,children:i.jsx("div",{className:"text-center px-4 sm:px-6",children:i.jsx("p",{className:""+(F?"text-gray-300":"text-gray-600"),children:"No homework details available"})})})};export{N as default};
